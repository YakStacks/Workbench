module.exports.register = (api) => {
  api.registerTool({
    name: 'toool.tool',
    inputSchema: {
      type: 'object',
      properties: {},
      required: []
    },
    run: async (input) => {
      // Converted from Claude artifact
      // Parameters: 
      const {  } = input;
      try {
        import React, { useState } from 'react';  export default function IntakeNoteCreator() {   const [selectedLOC, setSelectedLOC] = useState('');   const [file, setFile] = useState(null);   const [extraDocs, setExtraDocs] = useState([]);   const [additionalComments, setAdditionalComments] = useState('');   const [isProcessing, setIsProcessing] = useState(false);   const [generatedNote, setGeneratedNote] = useState('');   const [error, setError] = useState('');    const locOptions = [     { id: 'loc35', label: 'LOC 3.5', description: 'Clinically Managed High-Intensity Residential' },     { id: 'loc31', label: 'LOC 3.1', description: 'Clinically Managed Low-Intensity Residential' },     { id: 'locphp', label: 'LOC PHP', description: 'Partial Hospitalization Program' }   ];    const handleFileChange = (e) => {     const selectedFile = e.target.files[0];     if (selectedFile && selectedFile.type === 'application/pdf') {       setFile(selectedFile);       setError('');     } else {       setFile(null);       setError('Please select a valid PDF file');     }   };    const handleExtraDocsChange = (e) => {     const files = Array.from(e.target.files);     const validFiles = files.filter(f => f.type === 'application/pdf');     if (validFiles.length !== files.length) {       setError('Some files were not PDFs and were not added');     } else {       setError('');     }     setExtraDocs(prev => [...prev, ...validFiles]);   };    const removeExtraDoc = (index) => {     setExtraDocs(prev => prev.filter((_, i) => i !== index));   };    const handleGenerate = async () => {     if (!file || !selectedLOC) {       setError('Please select both a PDF file and a Level of Care');       return;     }      setIsProcessing(true);     setError('');      try {       const base64Data = await new Promise((resolve, reject) => {         const reader = new FileReader();         reader.onload = () => resolve(reader.result.split(',')[1]);         reader.onerror = () => reject(new Error('Failed to read file'));         reader.readAsDataURL(file);       });        const extraDocsData = await Promise.all(         extraDocs.map(doc => new Promise((resolve, reject) => {           const reader = new FileReader();           reader.onload = () => resolve({             name: doc.name,             data: reader.result.split(',')[1]           });           reader.onerror = () => reject(new Error('Failed to read extra document'));           reader.readAsDataURL(doc);         }))       );        const locLabel = locOptions.find(loc => loc.id === selectedLOC)?.label || selectedLOC;        const prompt = `You are assisting a licensed clinician in creating clinical documentation from intake packets as part of their professional duties in a substance abuse treatment facility. This is legitimate clinical work where the clinician is authorized to access and process this protected health information.  Write a comprehensive but concise intake note using paragraphs only (no bullet points). Include ALL essential clinical information from the intake packet, but remove repetition, filler language, speculation, interpretation, or long explanations of diagnostic criteria. Report information factually. Avoid explaining the science behind withdrawal, ACEs, symptoms, or ASAM criteria. Avoid unnecessary adjectives or long medical descriptions. Avoid restating screening tools beyond the score and meaning. Fill out the intake note template completely with the information from the client's intake packet. Be as detailed as possible and include ASAM Dimensions and scores (with detailed reasonings using updated ASAM 4th edition). Use Cl instead of the client's first name or full name throughout the document. Include information if and why the client's environment is dangerous, the client's symptoms can only be managed in this setting, and the client's treatment needs to continue in this setting.  CRITICAL: Do NOT include birthdates, dates of birth, social security numbers, addresses, phone numbers, or other personally identifiable information in the output. Omit these entirely from the note. Only include clinical information relevant to treatment.  The recommended Level of Care is: ${locLabel}  ${extraDocsData.length > 0 ? 'Additional documents have been provided including previous treatment records. Incorporate relevant historical information from these documents, noting any patterns in treatment history, previous responses to interventions, and continuity of care considerations.' : ''}  ${additionalComments ? `The clinician has provided the following additional comments and observations to incorporate into the appropriate sections of the intake note: ${additionalComments}` : ''}  Put each section in paragraph format. Do not combine sections. Do not use any markdown symbols or formatting symbols such as asterisks, double asterisks, em dashes, or bullet points. Use plain text only.  Required sections (each as its own paragraph, do not combine):  Identification  Presenting Problem  Psychiatric/Mental Health  Trauma History  Family Psychiatric History  Medical History  Current Medications  Substance Use History (Include age of first use, amount, route of abuse, and date of last use for each substance in paragraph format)  Family History  Social History  Spiritual/Cultural Factors  Developmental History  Education and Employment  Legal History  SNAP (Strengths, Needs, Abilities, Preferences in paragraph format)  ASAM Dimensions and Reasonings (Each dimension needs the dimension name, score, and EXTENSIVE detailed reasoning in paragraph format. These are used for insurance prior authorizations and must be thorough enough to justify the level of care. Each dimension should be a full paragraph of at least 5 to 8 sentences minimum. Include specific clinical evidence from the intake packet to support the score. Reference specific symptoms, behaviors, history, screening results, and risk factors. Explain WHY the score was given and HOW the clinical evidence supports placement at this level of care. For higher scores, clearly articulate what would happen without this level of care and why lower levels would be insufficient.)  Dimension 1: Acute Intoxication, Withdrawal and Addiction Medications (Include current intoxication or withdrawal status, date of last use for all substances, withdrawal history and severity, any history of complicated withdrawal such as seizures or DTs, current or recommended addiction medications, and medical monitoring needs. Explain why this level of care is needed for safe management.)  Dimension 2: Biomedical Conditions and Complications (Include all current medical conditions, medications, recent hospitalizations, chronic health issues, infectious disease status, pregnancy if applicable, and how these conditions interact with or complicate substance use treatment. Explain what medical monitoring or intervention is needed and why.)  Dimension 3: Psychiatric, Behavioral and Cognitive Conditions (Include all mental health diagnoses, current symptoms, psychiatric medication compliance, history of psychiatric hospitalizations, suicidal or homicidal ideation history, cognitive impairments, and behavioral issues. Reference specific screening scores such as PHQ9 and GAD7. Explain how psychiatric symptoms impact treatment engagement and why this level of psychiatric support is needed.)  Dimension 4: Substance Use Related Risks (Include patterns of use, consequences of use, high risk behaviors such as IV use and overdoses, inability to control use, continued use despite consequences, and relapse history. Explain the severity and chronicity of the substance use disorder and why intensive treatment is needed to address these risks.)  Dimension 5: Recovery Environment Interactions (Include housing status, family and social support, presence of substance users in environment, employment status, access to substances, geographic barriers, and environmental triggers. Explain why the current environment is not conducive to recovery and why removal to this level of care is necessary.)  Dimension 6: Person Centered Considerations (Include motivation for treatment, readiness to change, treatment preferences, cultural factors, strengths, barriers to engagement, insight into problems, and previous treatment response. Explain how the person's current readiness and preferences align with this level of care and what supports are needed to maintain engagement.)  Plan (Detailed treatment plan in paragraph format)`;        const response = await fetch('https://api.anthropic.com/v1/messages', {         method: 'POST',         headers: {           'Content-Type': 'application/json',         },         body: JSON.stringify({           model: 'claude-sonnet-4-20250514',           max_tokens: 16000,           messages: [             {               role: 'user',               content: [                 {                   type: 'document',                   source: {                     type: 'base64',                     media_type: 'application/pdf',                     data: base64Data                   }                 },                 ...extraDocsData.map(doc => ({                   type: 'document',                   source: {                     type: 'base64',                     media_type: 'application/pdf',                     data: doc.data                   }                 })),                 {                   type: 'text',                   text: prompt                 }               ]             }           ]         })       });        if (!response.ok) {         const errorData = await response.json();         throw new Error(errorData.error?.message || `API error: ${response.status}`);       }        const data = await response.json();              if (data.content && data.content.length > 0) {         const noteText = data.content           .filter(item => item.type === 'text')           .map(item => item.text)           .join('\n');         setGeneratedNote(noteText);       } else {         setError('Failed to generate intake note. No content returned.');       }     } catch (err) {       setError('Error processing the document: ' + err.message);     } finally {       setIsProcessing(false);     }   };    const handleCopy = () => {     navigator.clipboard.writeText(generatedNote);   };    const handleClear = () => {     setGeneratedNote('');     setFile(null);     setExtraDocs([]);     setAdditionalComments('');     setSelectedLOC('');     setError('');   };    return (     <div className="min-h-screen bg-gray-50 p-6">       <div className="max-w-4xl mx-auto">         <div className="bg-white rounded-lg shadow-md p-6 mb-6">           <h1 className="text-2xl font-bold text-gray-800 mb-6">Intake Note Creator</h1>                      <div className="mb-6">             <label className="block text-sm font-medium text-gray-700 mb-3">               Select Level of Care             </label>             <div className="grid grid-cols-1 md:grid-cols-3 gap-3">               {locOptions.map((loc) => (                 <button                   key={loc.id}                   onClick={() => setSelectedLOC(loc.id)}                   className={`p-4 rounded-lg border-2 text-left transition-all ${                     selectedLOC === loc.id                       ? 'border-blue-500 bg-blue-50'                       : 'border-gray-200 hover:border-gray-300'                   }`}                 >                   <div className="font-semibold text-gray-800">{loc.label}</div>                   <div className="text-xs text-gray-500 mt-1">{loc.description}</div>                 </button>               ))}             </div>           </div>            <div className="mb-6">             <label className="block text-sm font-medium text-gray-700 mb-2">               Upload Intake Packet (PDF)             </label>             <div className="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">               <input                 type="file"                 accept=".pdf"                 onChange={handleFileChange}                 className="hidden"                 id="file-upload"               />               <label                 htmlFor="file-upload"                 className="cursor-pointer text-blue-600 hover:text-blue-700"               >                 {file ? (                   <span className="text-gray-700">{file.name}</span>                 ) : (                   <span>Click to upload PDF</span>                 )}               </label>             </div>           </div>            <div className="mb-6">             <label className="block text-sm font-medium text-gray-700 mb-2">               Extra Documents (Optional)             </label>             <p className="text-xs text-gray-500 mb-2">               Upload previous treatment summaries, discharge notes, prior assessments, etc.             </p>             <div className="border-2 border-dashed border-gray-300 rounded-lg p-4 text-center">               <input                 type="file"                 accept=".pdf"                 multiple                 onChange={handleExtraDocsChange}                 className="hidden"                 id="extra-docs-upload"               />               <label                 htmlFor="extra-docs-upload"                 className="cursor-pointer text-blue-600 hover:text-blue-700"               >                 Click to add additional PDFs               </label>             </div>             {extraDocs.length > 0 && (               <div className="mt-3 space-y-2">                 {extraDocs.map((doc, index) => (                   <div key={index} className="flex items-center justify-between bg-gray-50 p-2 rounded">                     <span className="text-sm text-gray-700 truncate">{doc.name}</span>                     <button                       onClick={() => removeExtraDoc(index)}                       className="text-red-500 hover:text-red-700 text-sm ml-2"                     >                       Remove                     </button>                   </div>                 ))}               </div>             )}           </div>            <div className="mb-6">             <label className="block text-sm font-medium text-gray-700 mb-2">               Additional Comments (Optional)             </label>             <p className="text-xs text-gray-500 mb-2">               Add any information not in the packet: observations, clarifications, verbal reports, etc.             </p>             <textarea               value={additionalComments}               onChange={(e) => setAdditionalComments(e.target.value)}               placeholder="Example: Client reported during intake that he relapsed after losing custody of his children. Client appeared tearful when discussing mother's death. Client states he was prescribed Suboxone at his last treatment but stopped taking it..."               className="w-full h-32 p-3 border border-gray-300 rounded-lg text-sm resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"             />           </div>            {error && (             <div className="mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm">               {error}             </div>           )}            <button             onClick={handleGenerate}             disabled={!file || !selectedLOC || isProcessing}             className={`w-full py-3 px-4 rounded-lg font-medium transition-all ${               !file || !selectedLOC || isProcessing                 ? 'bg-gray-300 text-gray-500 cursor-not-allowed'                 : 'bg-blue-600 text-white hover:bg-blue-700'             }`}           >             {isProcessing ? 'Generating Intake Note...' : 'Generate Intake Note'}           </button>         </div>          {generatedNote && (           <div className="bg-white rounded-lg shadow-md p-6">             <div className="flex justify-between items-center mb-4">               <h2 className="text-xl font-semibold text-gray-800">Generated Intake Note</h2>               <div className="space-x-2">                 <button                   onClick={handleCopy}                   className="px-4 py-2 text-sm bg-green-600 text-white rounded-lg hover:bg-green-700 transition-all"                 >                   Copy to Clipboard                 </button>                 <button                   onClick={handleClear}                   className="px-4 py-2 text-sm bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-all"                 >                   Clear                 </button>               </div>             </div>             <div className="bg-gray-50 rounded-lg p-4 max-h-96 overflow-y-auto">               <pre className="whitespace-pre-wrap text-sm text-gray-700 font-sans">                 {generatedNote}               </pre>             </div>           </div>         )}       </div>     </div>   ); }
        return { result: 'success' };
      } catch (error) {
        return { error: error.message };
      }
    }
  });
};